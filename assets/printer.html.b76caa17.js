import{_ as p,r as e,o,c,b as s,d as a,e as l,a as i}from"./app.96ddbfb7.js";var u="/assets/java_printer.f6772a37.png";const k={},r={href:"https://blog.csdn.net/m0_46267097/article/details/112609095",target:"_blank",rel:"noopener noreferrer"};function d(m,n){const t=e("ExternalLinkIcon");return o(),c("div",null,[n[2]||(n[2]=s("h4",{id:"\u57FA\u7840\u601D\u8DEF",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#\u57FA\u7840\u601D\u8DEF","aria-hidden":"true"},"#"),a(" \u57FA\u7840\u601D\u8DEF")],-1)),s("p",null,[s("a",r,[n[0]||(n[0]=a("\u53C2\u8003\u5730\u5740")),l(t)]),n[1]||(n[1]=s("img",{src:u,alt:""},null,-1))]),n[3]||(n[3]=i(`<h4 id="java-\u793A\u4F8B" tabindex="-1"><a class="header-anchor" href="#java-\u793A\u4F8B" aria-hidden="true">#</a> java \u793A\u4F8B</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>html2pdf<span class="token punctuation">.</span></span><span class="token class-name">ConverterProperties</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>html2pdf<span class="token punctuation">.</span></span><span class="token class-name">HtmlConverter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>html2pdf<span class="token punctuation">.</span>resolver<span class="token punctuation">.</span>font<span class="token punctuation">.</span></span><span class="token class-name">DefaultFontProvider</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>io<span class="token punctuation">.</span>font<span class="token punctuation">.</span></span><span class="token class-name">FontProgram</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>io<span class="token punctuation">.</span>font<span class="token punctuation">.</span></span><span class="token class-name">FontProgramFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>kernel<span class="token punctuation">.</span>geom<span class="token punctuation">.</span></span><span class="token class-name">PageSize</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>kernel<span class="token punctuation">.</span>pdf<span class="token punctuation">.</span></span><span class="token class-name">PdfDocument</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>kernel<span class="token punctuation">.</span>pdf<span class="token punctuation">.</span></span><span class="token class-name">PdfWriter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>layout<span class="token punctuation">.</span></span><span class="token class-name">Document</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>itextpdf<span class="token punctuation">.</span>layout<span class="token punctuation">.</span>font<span class="token punctuation">.</span></span><span class="token class-name">FontProvider</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>pdfbox<span class="token punctuation">.</span>pdmodel<span class="token punctuation">.</span></span><span class="token class-name">PDDocument</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>pdfbox<span class="token punctuation">.</span>printing<span class="token punctuation">.</span></span><span class="token class-name">PDFPageable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>pdfbox<span class="token punctuation">.</span>printing<span class="token punctuation">.</span></span><span class="token class-name">PDFPrintable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>pdfbox<span class="token punctuation">.</span>printing<span class="token punctuation">.</span></span><span class="token class-name">Scaling</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>print<span class="token punctuation">.</span></span><span class="token class-name">PrintService</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>print<span class="token punctuation">.</span></span><span class="token class-name">Book</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>print<span class="token punctuation">.</span></span><span class="token class-name">PageFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>print<span class="token punctuation">.</span></span><span class="token class-name">Paper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>awt<span class="token punctuation">.</span>print<span class="token punctuation">.</span></span><span class="token class-name">PrinterJob</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">OutputStream</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * \u6253\u5370\u673A\u76F8\u5173\u5DE5\u5177\u7C7B
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrinterUtils</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u6A21\u677F\u5B57\u7B26\u4E32</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> templateStr <span class="token operator">=</span> <span class="token string">&quot;&lt;div style=\\&quot;width: 6cm; height: 4cm;\\&quot;&gt;&lt;/div&gt;&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// \u6253\u5370\u7EB8\u5BBD\u5EA6\u82F1\u5BF8*72</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> pageWidth <span class="token operator">=</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">72</span><span class="token punctuation">;</span>
    <span class="token comment">// \u6253\u5370\u7EB8\u9AD8\u5EA6\u82F1\u5BF8*72</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Integer</span> pageHeight <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token number">72</span><span class="token punctuation">;</span>
    <span class="token comment">// \u6253\u5370\u673A\u540D\u79F0</span>
<span class="token comment">//    private String printerName = &quot;\\\\\\\\192.168.0.17\\\\ZDesigner GX430t&quot;;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">String</span> printerName <span class="token operator">=</span> <span class="token string">&quot;ZDesigner GX430t (\u526F\u672C 1)&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// \u6839\u636Ehtml\u5B57\u7B26\u4E32\u751F\u6210\u7684pdf\u5730\u5740</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> pdfPath <span class="token operator">=</span> <span class="token string">&quot;D:\\\\lscf\\\\test.pdf&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// \u5B57\u4F53\u6587\u4EF6\u5B58\u653E\u5730\u5740</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> fontPath <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;user.dir&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\\\\ruoyi-common\\\\src\\\\main\\\\resources\\\\fonts\\\\msyhbd.ttc,0&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//    private static final String fontPath = &quot;D:\\\\lscf\\\\msyhbd.ttc,0&quot;;</span>

    <span class="token doc-comment comment">/**
     * \u6253\u5370\u5165\u53E3
     * <span class="token keyword">@param</span> <span class="token parameter">printStr</span>
     * <span class="token keyword">@return</span>
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token class-name">String</span> printStr<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// html\u5B57\u7B26\u4E32\u8F6Cpdf</span>
        <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span><span class="token function">htmlStrToPdf</span><span class="token punctuation">(</span>printStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u6839\u636E\u6253\u5370\u673A\u540D\u79F0\u548Cpdf\u8DEF\u5F84\u6253\u5370pdf</span>
        <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span><span class="token function">printPdf</span><span class="token punctuation">(</span><span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>pdfPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token class-name">String</span> printStr<span class="token punctuation">,</span> <span class="token class-name">String</span> printerName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span><span class="token function">setPrinterName</span><span class="token punctuation">(</span>printerName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>printStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token doc-comment comment">/**
     * html\u5B57\u7B26\u4E32\u8F6C\u5316\u4E3Apdf
     * <span class="token keyword">@param</span> <span class="token parameter">htmlStr</span>
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> htmlStrToPdf <span class="token punctuation">(</span><span class="token class-name">String</span> htmlStr<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u914D\u7F6E\u5B57\u4F53\u6587\u4EF6</span>
        <span class="token class-name">ConverterProperties</span> converterProperties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConverterProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FontProvider</span> fontProvider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultFontProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FontProgram</span> fontProgram <span class="token operator">=</span> <span class="token class-name">FontProgramFactory</span><span class="token punctuation">.</span><span class="token function">createFont</span><span class="token punctuation">(</span><span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>fontPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        fontProvider<span class="token punctuation">.</span><span class="token function">addFont</span><span class="token punctuation">(</span>fontProgram<span class="token punctuation">)</span><span class="token punctuation">;</span>
        converterProperties<span class="token punctuation">.</span><span class="token function">setFontProvider</span><span class="token punctuation">(</span>fontProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u521B\u5EFApdf</span>
        <span class="token class-name">OutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>pdfPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PdfWriter</span> pdfWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfWriter</span><span class="token punctuation">(</span>fileOutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u521B\u5EFA\u9875\u9762</span>
        <span class="token class-name">PdfDocument</span> doc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PdfDocument</span><span class="token punctuation">(</span>pdfWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PageSize</span> pageSize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageSize</span><span class="token punctuation">(</span> <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>pageWidth <span class="token operator">*</span> <span class="token number">1.38f</span><span class="token punctuation">,</span><span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>pageHeight <span class="token operator">*</span> <span class="token number">1.38f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        doc<span class="token punctuation">.</span><span class="token function">setDefaultPageSize</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// html\u8F6Cpdf</span>
        <span class="token class-name">Document</span> document <span class="token operator">=</span> <span class="token class-name">HtmlConverter</span><span class="token punctuation">.</span><span class="token function">convertToDocument</span><span class="token punctuation">(</span>htmlStr<span class="token punctuation">,</span>doc<span class="token punctuation">,</span>converterProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">getRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        document<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5F00\u59CB\u6253\u5370pdf
     * <span class="token keyword">@param</span> <span class="token parameter">pdfPath</span>
     * <span class="token keyword">@return</span>
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printPdf</span><span class="token punctuation">(</span><span class="token class-name">String</span> pdfPath<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>pdfPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PDDocument</span> document <span class="token operator">=</span> <span class="token class-name">PDDocument</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u6839\u636E\u6253\u5370\u673A\u540D\u79F0\u83B7\u53D6\u6253\u5370\u673A</span>
        <span class="token class-name">PrinterJob</span> job <span class="token operator">=</span> <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span><span class="token function">getPrintServiceByName</span><span class="token punctuation">(</span><span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>printerName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u6253\u5370\u6837\u5F0F</span>
        <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span><span class="token function">setPageStyle</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> job<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u5F00\u59CB\u6253\u5370</span>
        job<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">printPdf</span><span class="token punctuation">(</span><span class="token class-name">String</span> pdfPath<span class="token punctuation">,</span> <span class="token class-name">String</span> printerName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span><span class="token function">setPrinterName</span><span class="token punctuation">(</span>printerName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span><span class="token function">printPdf</span><span class="token punctuation">(</span>pdfPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u6839\u636E\u6253\u5370\u673A\u540D\u79F0\u83B7\u53D6\u6253\u5370\u673A\u670D\u52A1
     * <span class="token keyword">@param</span> <span class="token parameter">printerName</span>
     * <span class="token keyword">@return</span>
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">PrinterJob</span> <span class="token function">getPrintServiceByName</span><span class="token punctuation">(</span><span class="token class-name">String</span> printerName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">{</span>
        <span class="token class-name">PrinterJob</span> job <span class="token operator">=</span> <span class="token class-name">PrinterJob</span><span class="token punctuation">.</span><span class="token function">getPrinterJob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u904D\u5386\u67E5\u8BE2\u6253\u5370\u673A\u540D\u79F0</span>
        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">PrintService</span> ps <span class="token operator">:</span> <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span><span class="token function">getPrinterServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> psName <span class="token operator">=</span> ps<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\u641C\u7D22\u5230\u6253\u5370\u673A\u540D\uFF1A&quot;</span> <span class="token operator">+</span> psName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u9009\u7528\u6307\u5B9A\u6253\u5370\u673A\uFF0C\u9700\u8981\u7CBE\u786E\u67E5\u8BE2\u6253\u5370\u673A\u5C31\u7528equals\uFF0C\u6A21\u7CCA\u67E5\u8BE2\u7528contains</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>psName<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>printerName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                job<span class="token punctuation">.</span><span class="token function">setPrintService</span><span class="token punctuation">(</span>ps<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>flag<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;\u6253\u5370\u5931\u8D25\uFF0C\u672A\u627E\u5230\u540D\u79F0\u4E3A&quot;</span> <span class="token operator">+</span> printerName <span class="token operator">+</span> <span class="token string">&quot;\u7684\u6253\u5370\u673A\uFF0C\u8BF7\u68C0\u67E5\u3002&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> job<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u8BBE\u7F6E\u6253\u5370\u53C2\u6570
     * <span class="token keyword">@param</span> <span class="token parameter">document</span>
     * <span class="token keyword">@param</span> <span class="token parameter">job</span>
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setPageStyle</span><span class="token punctuation">(</span><span class="token class-name">PDDocument</span> document<span class="token punctuation">,</span> <span class="token class-name">PrinterJob</span> job<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        job<span class="token punctuation">.</span><span class="token function">setPageable</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PDFPageable</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Paper</span> paper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Paper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u6253\u5370\u7EB8\u5F20\u5927\u5C0F</span>
        paper<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span><span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>pageWidth<span class="token punctuation">,</span><span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>pageHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u8FB9\u8DDD\uFF0C\u5355\u4F4D\u662F\u50CF\u7D20\uFF0C10mm\u8FB9\u8DDD\uFF0C\u5BF9\u5E94 28px</span>
        <span class="token keyword">int</span> marginLeft <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">14</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> marginRight <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">14</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> marginTop <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">14</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> marginBottom <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">14</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u6253\u5370\u4F4D\u7F6E \u5750\u6807</span>
        paper<span class="token punctuation">.</span><span class="token function">setImageableArea</span><span class="token punctuation">(</span>marginLeft<span class="token punctuation">,</span> marginRight<span class="token punctuation">,</span> <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>pageWidth <span class="token operator">-</span> <span class="token punctuation">(</span>marginLeft <span class="token operator">+</span> marginRight<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>pageHeight <span class="token operator">-</span> <span class="token punctuation">(</span>marginTop <span class="token operator">+</span> marginBottom<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">PageFormat</span> pageFormat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PageFormat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pageFormat<span class="token punctuation">.</span><span class="token function">setPaper</span><span class="token punctuation">(</span>paper<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Book</span> book <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BBE\u7F6E\u4E00\u4E9B\u5C5E\u6027 \u662F\u5426\u7F29\u653E \u6253\u5370\u5F20\u6570\u7B49</span>
        book<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PDFPrintable</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token class-name">Scaling</span><span class="token punctuation">.</span><span class="token constant">SCALE_TO_FIT</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pageFormat<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        job<span class="token punctuation">.</span><span class="token function">setPageable</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u8BBE\u7F6E\u6253\u5370\u673A\u540D\u79F0
     * <span class="token keyword">@param</span> <span class="token parameter">name</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">setPrinterName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">PrinterUtils</span><span class="token punctuation">.</span>printerName <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u83B7\u53D6\u6253\u5370\u673A\u5217\u8868
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">PrintService</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getPrinterServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">PrinterJob</span><span class="token punctuation">.</span><span class="token function">lookupPrintServices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="maven-\u4F9D\u8D56" tabindex="-1"><a class="header-anchor" href="#maven-\u4F9D\u8D56" aria-hidden="true">#</a> maven \u4F9D\u8D56</h4><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code>        <span class="token comment">&lt;!-- pdfBox--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.pdfbox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>pdfbox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.21<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- itextpdf--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.itextpdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>itextpdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.5.13<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.itextpdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>itext-asian<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.itextpdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>kernel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>7.1.14<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.itextpdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>html2pdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.0.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4))])}var b=p(k,[["render",d],["__file","printer.html.vue"]]);export{b as default};
